<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Comptoir Digital — Maintenance Multi-Boutiques</title>
  <style>
    :root{
      --brand:#153d68;
      --bg:#f6f7fb;
      --card:#ffffff;
      --text:#1f2937;
      --muted:#6b7280;
      --radius:16px;
      --shadow:0 8px 24px rgba(0,0,0,.08);
      --gap:12px;
      --pad:8px;
      --header-h:64px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; background:var(--bg); color:var(--text);
      font:16px/1.5 system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
    }

    /* Header */
    .site-header{position:sticky; top:0; z-index:20; height:var(--header-h);
      background:var(--brand); color:#fff; box-shadow:0 2px 10px rgba(0,0,0,.1)}
    .header-inner{height:100%; display:flex; align-items:center; gap:14px; padding:0 14px}
    .brand{display:flex; align-items:center; gap:12px; min-width:0; flex:1}
    .brand img{height:34px; width:auto; display:block; filter:drop-shadow(0 1px 0 rgba(0,0,0,.2))}
    .brand-title{font-weight:600; letter-spacing:.2px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis}
    
    .logout-btn {
      background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2);
      color: #fff; padding: 6px 12px; border-radius: 6px; cursor: pointer; font-size: 12px;
    }
    .logout-btn:hover { background: rgba(255,255,255,0.2); }

    /* Layout */
    .wrap{padding:var(--pad); height:calc(100vh - var(--header-h))}
    .grid{display:grid; gap:var(--gap); grid-template-columns:1fr 2fr; height:100%}
    @media (max-width: 980px){ .grid{grid-template-columns:1fr} }

    .panel{background:var(--card); border-radius:var(--radius); box-shadow:var(--shadow);
      display:flex; flex-direction:column; overflow:hidden; min-height:0}
    .panel-header{padding:10px 12px; background:linear-gradient(0deg, rgba(0,0,0,0.02), rgba(0,0,0,0.02));
      border-bottom:1px solid #eef1f6; display:flex; align-items:center; gap:10px; flex:0 0 auto}
    .dot{width:10px; height:10px; border-radius:50%} .red{background:#ef4444}.yellow{background:#f59e0b}.green{background:#10b981}
    .panel-title{font-size:14px; color:var(--muted)}

    .frame{position:relative; flex:1 1 auto; min-height:0; overflow:hidden;}
    .frame iframe{position:absolute; left:0; right:0; top:0; width:100%; height:100%; border:0;}

    /* Login */
    .gate{position:fixed; inset:0; background:var(--bg); display:flex; align-items:center; justify-content:center; z-index:50;}
    .gate-card{width:100%; max-width:400px; background:#fff; border-radius:14px; box-shadow:var(--shadow); padding:30px; text-align:center;}
    .gate-card h1{margin:0 0 20px; font-size:22px; color:var(--brand)}
    .input-group{text-align:left; margin-bottom:15px}
    .input-group label{display:block; font-size:13px; margin-bottom:5px; color:var(--muted); font-weight:500}
    .gate-card input{width:100%; padding:12px; border-radius:8px; border:1px solid #e5e7eb; outline:0; font-size:14px;}
    .btn{width:100%; padding:12px; border:0; border-radius:8px; cursor:pointer; font-weight:600; margin-top:10px;}
    .btn-primary{background:var(--brand); color:#fff}
    .gate-error{color:#dc2626; font-size:13px; margin-top:15px; min-height:1.2em}

    .hidden{display:none !important}
  </style>
</head>
<body>

  <header class="site-header">
    <div class="header-inner">
      <div class="brand">
        <img src="https://comptoirdigital.com/wp-content/uploads/2024/09/Horizontal-2-e1728243487280.png" alt="Logo"/>
        <div id="dynamic-title" class="brand-title">— Maintenance</div>
      </div>
      <button id="logout-ui" class="logout-btn hidden" onclick="logout()">Déconnexion</button>
    </div>
  </header>

  <div id="gate" class="gate">
    <div class="gate-card">
      <h1>Accès Maintenance</h1>
      <div class="input-group">
        <label>Email client</label>
        <input id="email" type="email" placeholder="client@email.com" />
      </div>
      <div class="input-group">
        <label>Mot de passe</label>
        <input id="pwd" type="password" placeholder="••••••••" />
      </div>
      <button class="btn btn-primary" onclick="login()">Se connecter</button>
      <div id="gateErr" class="gate-error"></div>
    </div>
  </div>

  <main id="content" class="wrap hidden">
    <div class="grid">
      <section class="panel">
        <div class="panel-header">
          <span class="dot red"></span><span class="dot yellow"></span><span class="dot green"></span>
          <span class="panel-title">Formulaire de demande</span>
        </div>
        <div class="frame">
          <iframe id="iframe-form" src="" allowfullscreen></iframe>
        </div>
      </section>

      <section class="panel">
        <div class="panel-header">
          <span class="dot red"></span><span class="dot yellow"></span><span class="dot green"></span>
          <span id="panel-shop-name" class="panel-title">Suivi Maintenance</span>
        </div>
        <div class="frame">
          <iframe id="iframe-main" src="" allowfullscreen></iframe>
        </div>
      </section>
    </div>
  </main>

  <script>
    const USERS = {
      "vanessa.bussinger@gmail.com": {
        pass: "tihani1",
        name: "Tihani",
        formUrl: "https://forms.trll.io/SVqd3zG5/formulaire-de-demande?embed=iframe",
        mainUrl: "https://trll.io/Tmb9ZbF2hd/maintenance-tihani?pwd=WVFzT008o5L2vFD-"
      },
      "	x.gambade@gmail.com": { // Remplacez par le mail réel du client Plancha
        pass: "plancha1",
        name: "Carrément Plancha",
        formUrl: "https://forms.trll.io/-wZbYACA/formulaire-de-demande?embed=iframe",
        mainUrl: "https://trll.io/j25DYtXttk/maintenance-carrément-plancha?pwd=S_j75Rmk4vPNZCGz"
      }
    };

    function login() {
      const email = document.getElementById('email').value.trim().toLowerCase();
      const pwd = document.getElementById('pwd').value;
      const err = document.getElementById('gateErr');
      const user = USERS[email];

      if (user && user.pass === pwd) {
        setupDashboard(user);
        sessionStorage.setItem('active_user', email);
      } else {
        err.textContent = "Identifiants incorrects.";
      }
    }

    function setupDashboard(user) {
      document.getElementById('dynamic-title').textContent = "— Maintenance " + user.name;
      document.getElementById('panel-shop-name').textContent = "Suivi — " + user.name;
      document.getElementById('iframe-form').src = user.formUrl;
      document.getElementById('iframe-main').src = user.mainUrl;

      document.getElementById('gate').classList.add('hidden');
      document.getElementById('content').classList.remove('hidden');
      document.getElementById('logout-ui').classList.remove('hidden');
    }

    function logout() {
      sessionStorage.removeItem('active_user');
      window.location.reload();
    }

    (function(){
      const saved = sessionStorage.getItem('active_user');
      if (saved && USERS[saved]) setupDashboard(USERS[saved]);
      
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' && !document.getElementById('gate').classList.contains('hidden')) login();
      });
    })();
  </script>
</body>
</html>
